<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Escape Room Editor</title>
  <link rel="stylesheet" href="style.css">
  <style>
    .content-block {
      background: #fff;
      padding: 10px;
      border: 1px solid #ccc;
      border-left: 5px solid #ffe600;
      border-radius: 5px;
      margin-bottom: 10px;
      position: relative;
    }
    .content-block .remove-btn {
      position: absolute;
      right: 8px;
      top: 8px;
      background: #ff4d4d;
      color: white;
      border: none;
      border-radius: 4px;
      padding: 4px 8px;
      cursor: pointer;
    }
  </style>
</head>
<body>

  <!-- TOP BAR -->
  <header class="topbar">
    <span>Escape-Room Editor</span>
    <span>Dr Alex Nguyen</span>
    <a href="#">Manage</a>
    <a href="#">Log out</a>
  </header>

  <div class="layout">

    <!-- SIDEBAR -->
    <aside class="sidebar" id="thumbs">
      <div class="thumb active" data-tpl="tmpl-text"><div class="thumb-preview"></div></div>
      <div class="thumb" data-tpl="tmpl-video"><div class="thumb-preview"></div></div>
      <div class="thumb" data-tpl="tmpl-mcq"><div class="thumb-preview"></div></div>
      <div class="thumb" data-tpl="tmpl-blank"><div class="thumb-preview"></div></div>
      <div class="thumb" data-tpl="tmpl-interactive"><div class="thumb-preview"></div></div>
      <div class="thumb" data-tpl="tmpl-image"><div class="thumb-preview"></div></div>
    </aside>

    <!-- WHITEBOARD + CONTROLS + FEEDBACK -->
    <div class="whiteboard-wrapper">
      <div id="wb" class="whiteboard" contenteditable="true">
        Double-click and start typing your story …
      </div>
      <div class="controls">
        <button onclick="saveProgress()">Save Progress</button>
        <button onclick="prevSlide()">Previous</button>
        <button onclick="submitAnswer()">Submit</button>
      </div>
      <div id="feedbackPopup" class="feedback-popup hidden">
        <p id="feedbackText">Feedback</p>
        <button onclick="closeFeedback()">OK</button>
      </div>
    </div>

    <!-- TOOLBAR -->
    <aside class="toolbar">
      <h2>Slide settings</h2>
      <label>Background color<input type="color" id="bgPicker" value="#ffffff"></label>
      <label>Text color<input type="color" id="fgPicker" value="#000000"></label>
      <label>Font size (px)<input type="number" id="fsPicker" value="16" min="10" max="72"></label>
    </aside>

  </div>

  <!-- TEMPLATES -->
  <template id="tmpl-text">Double-click and start typing your story …</template>
  <template id="tmpl-video">
    <p>Paste a YouTube/Vimeo embed link:</p>
    <textarea placeholder="https://www.youtube.com/embed/…"></textarea>
  </template>
  <template id="tmpl-mcq">
    <h3 contenteditable="true">What is the capital of Australia?</h3>
    <ul>
      <li contenteditable="true">Sydney</li>
      <li contenteditable="true">Melbourne</li>
      <li contenteditable="true">Canberra</li>
      <li contenteditable="true">Perth</li>
    </ul>
  </template>
  <template id="tmpl-blank">
    <p contenteditable="true">The chemical symbol for water is <u>______</u>.</p>
  </template>
  <template id="tmpl-interactive">
    <p><strong>Conditional Question (example)</strong></p>
    <p>If UID ends in odd → 3 × 7?  Even → 8 + 5?</p>
  </template>
  <template id="tmpl-image">
    <p>Insert an image:</p>
    <input type="file" accept="image/*" onchange="insertImage(event)">
  </template>

  <!-- JS -->
  <script>
    const wb=document.getElementById('wb');
    const slides=['tmpl-text','tmpl-video','tmpl-mcq','tmpl-blank','tmpl-interactive','tmpl-image'];
    let idx=0;
    let lastCorrect=false;

    /* style controls */
    bgPicker.oninput=e=>wb.style.setProperty('--wb-bg',e.target.value);
    fgPicker.oninput=e=>wb.style.setProperty('--wb-color',e.target.value);
    fsPicker.oninput=e=>wb.style.fontSize=e.target.value+'px';

    /* generate thumbnails once */
    document.querySelectorAll('.thumb').forEach((th,i)=>{
      const tpl=document.getElementById(th.dataset.tpl);
      if(tpl) th.querySelector('.thumb-preview').innerHTML=tpl.innerHTML;
      th.onclick=()=>{ idx=i; refresh(); };
    });

    function refresh(){
      document.querySelectorAll('.thumb').forEach(x=>x.classList.remove('active'));
      document.querySelectorAll('.thumb')[idx].classList.add('active');
      wb.innerHTML=document.getElementById(slides[idx]).innerHTML;
    }

    function saveProgress(){ alert('Progress saved!'); }
    function prevSlide(){ if(idx>0){ idx--; refresh(); }}
    function submitAnswer(){
      lastCorrect = Math.random()<0.5;
      const msg = lastCorrect ? '✔️ Correct!' : '❌ Incorrect. Try again.';
      document.getElementById('feedbackText').textContent = msg;
      document.getElementById('feedbackPopup').classList.remove('hidden');
    }

    function closeFeedback(){
      document.getElementById('feedbackPopup').classList.add('hidden');
      if(lastCorrect && idx<slides.length-1){ idx++; refresh(); }
    }

    function insertImage(ev){
      const f=ev.target.files[0]; if(!f) return;
      const img=document.createElement('img');
      img.src=URL.createObjectURL(f);
      img.style.maxWidth='100%';img.style.maxHeight='100%';
      wb.innerHTML='';wb.appendChild(img);
    }
  </script>
</body>
</html>